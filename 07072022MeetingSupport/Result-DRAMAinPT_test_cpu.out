True
DRAMAinPT_final starts!
finish loading networks
--------------------------star loading data-----------------------------------
--------------------------finish loading data-----------------------------------
safe (number of comparison): 164
safe (train number of comparison): 102
safe (val number of comparison): 8
safe (test number of comparison): 56
lively (number of comparison): 118
lively (train number of comparison): 74
lively (val number of comparison): 6
lively (test number of comparison): 40
batch:  0 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   2966.6 MiB   2966.6 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3780.8 MiB    814.2 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3780.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3780.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3780.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3780.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3780.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3780.8 MiB      0.1 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3781.2 MiB      0.4 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3781.2 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3781.2 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 1 / 51 loss of  safe = tensor(0.0725, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3797.2 MiB   3797.2 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3797.2 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3797.2 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3797.2 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3797.2 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3797.2 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3797.2 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3797.2 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3797.2 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3797.2 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3797.2 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 1 / 51 loss of  lively = tensor(3.2190, device='cuda:0', grad_fn=<AddBackward0>)
batch:  0 finished!
batch:  1 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3821.6 MiB   3821.6 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3821.6 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3821.6 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3821.6 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3821.6 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3821.6 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3821.6 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3821.6 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3821.6 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3821.6 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3821.6 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 2 / 51 loss of  safe = tensor(37.5014, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3824.5 MiB   3824.5 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3824.5 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3824.5 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3824.5 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3824.5 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3824.5 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3824.5 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3824.5 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3824.5 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3824.5 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3824.5 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 2 / 51 loss of  lively = tensor(10.0565, device='cuda:0', grad_fn=<AddBackward0>)
batch:  1 finished!
batch:  2 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3838.4 MiB   3838.4 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3838.4 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3838.4 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3838.4 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3838.4 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3838.4 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3838.4 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3838.4 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3838.4 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3838.4 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3838.4 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 3 / 51 loss of  safe = tensor(14.1183, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3838.5 MiB   3838.5 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3838.5 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3838.5 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3838.5 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3838.5 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3838.5 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3838.5 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3838.5 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3838.5 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3838.5 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3838.5 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 3 / 51 loss of  lively = tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
batch:  2 finished!
batch:  3 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3849.7 MiB   3849.7 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3849.7 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3849.7 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3849.7 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3849.7 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3849.7 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3849.7 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3849.7 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3849.7 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3849.7 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3849.7 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 4 / 51 loss of  safe = tensor(4.3489, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3849.8 MiB   3849.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3849.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3849.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3849.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3849.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3849.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3849.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3849.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3849.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3849.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3849.8 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 4 / 51 loss of  lively = tensor(6.4965, device='cuda:0', grad_fn=<AddBackward0>)
batch:  3 finished!
batch:  4 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3858.5 MiB   3858.5 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3858.5 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3858.5 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3858.5 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3858.5 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3858.5 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3858.5 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3858.5 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3858.5 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3858.5 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3858.5 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 5 / 51 loss of  safe = tensor(3.8927, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3858.7 MiB   3858.7 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3858.7 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3858.7 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3858.7 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3858.7 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3858.7 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3858.7 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3858.7 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3858.7 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3858.7 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3858.7 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 5 / 51 loss of  lively = tensor(2.2909, device='cuda:0', grad_fn=<AddBackward0>)
batch:  4 finished!
batch:  5 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3872.7 MiB   3872.7 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3872.7 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3872.7 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3872.7 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3872.7 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3872.7 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3872.7 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3872.7 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3872.7 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3872.7 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3872.7 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 6 / 51 loss of  safe = tensor(7.1909, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3872.8 MiB   3872.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3872.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3872.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3872.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3872.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3872.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3872.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3872.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3872.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3872.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3872.8 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 6 / 51 loss of  lively = tensor(0.0008, device='cuda:0', grad_fn=<AddBackward0>)
batch:  5 finished!
batch:  6 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3880.9 MiB   3880.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3880.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3880.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3880.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3880.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3880.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3880.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3880.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3880.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3880.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3880.9 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 7 / 51 loss of  safe = tensor(0.9270, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3886.1 MiB   3886.1 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3886.1 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3886.1 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3886.1 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3886.1 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3886.1 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3886.1 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3886.1 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3886.1 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3886.1 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3886.1 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 7 / 51 loss of  lively = tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
batch:  6 finished!
batch:  7 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3894.2 MiB   3894.2 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3894.2 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3894.2 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3894.2 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3894.2 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3894.2 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3894.2 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3894.2 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3894.2 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3894.2 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3894.2 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 8 / 51 loss of  safe = tensor(2.3178, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3894.3 MiB   3894.3 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3894.3 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3894.3 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3894.3 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3894.3 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3894.3 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3894.3 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3894.3 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3894.3 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3894.3 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3894.3 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 8 / 51 loss of  lively = tensor(27.5788, device='cuda:0', grad_fn=<AddBackward0>)
batch:  7 finished!
batch:  8 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3907.5 MiB   3907.5 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3907.5 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3907.5 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3907.5 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3907.5 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3907.5 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3907.5 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3907.5 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3907.5 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3907.5 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3907.5 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 9 / 51 loss of  safe = tensor(0.0008, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3907.6 MiB   3907.6 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3907.6 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3907.6 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3907.6 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3907.6 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3907.6 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3907.6 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3907.6 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3907.6 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3907.6 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3907.6 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 9 / 51 loss of  lively = tensor(11.9766, device='cuda:0', grad_fn=<AddBackward0>)
batch:  8 finished!
batch:  9 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3915.8 MiB   3915.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3915.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3915.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3915.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3915.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3915.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3915.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3915.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3915.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3915.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3915.8 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 10 / 51 loss of  safe = tensor(4.7516, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3918.2 MiB   3918.2 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3918.2 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3918.2 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3918.2 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3918.2 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3918.2 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3918.2 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3918.2 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3918.2 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3918.2 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3918.2 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 10 / 51 loss of  lively = tensor(0.0012, device='cuda:0', grad_fn=<AddBackward0>)
batch:  9 finished!
batch:  10 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3927.0 MiB   3927.0 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3927.0 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3927.0 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3927.0 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3927.0 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3927.0 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3927.0 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3927.0 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3927.0 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3927.0 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3927.0 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 11 / 51 loss of  safe = tensor(4.5167, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3927.2 MiB   3927.2 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3927.2 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3927.2 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3927.2 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3927.2 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3927.2 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3927.2 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3927.2 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3927.2 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3927.2 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3927.2 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 11 / 51 loss of  lively = tensor(0.0003, device='cuda:0', grad_fn=<AddBackward0>)
batch:  10 finished!
batch:  11 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3935.3 MiB   3935.3 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3935.3 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3935.3 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3935.3 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3935.3 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3935.3 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3935.3 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3935.3 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3935.3 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3935.3 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3935.3 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 12 / 51 loss of  safe = tensor(0.0009, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3940.0 MiB   3940.0 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3940.0 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3940.0 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3940.0 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3940.0 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3940.0 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3940.0 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3940.0 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3940.0 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3940.0 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3940.0 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 12 / 51 loss of  lively = tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
batch:  11 finished!
batch:  12 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3948.2 MiB   3948.2 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3948.2 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3948.2 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3948.2 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3948.2 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3948.2 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3948.2 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3948.2 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3948.2 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3948.2 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3948.2 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 13 / 51 loss of  safe = tensor(2.6970, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3948.3 MiB   3948.3 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3948.3 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3948.3 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3948.3 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3948.3 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3948.3 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3948.3 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3948.3 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3948.3 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3948.3 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3948.3 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 13 / 51 loss of  lively = tensor(0.9911, device='cuda:0', grad_fn=<AddBackward0>)
batch:  12 finished!
batch:  13 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3961.1 MiB   3961.1 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3961.1 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3961.1 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3961.1 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3961.1 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3961.1 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3961.1 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3961.1 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3961.1 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3961.1 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3961.1 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 14 / 51 loss of  safe = tensor(0.5695, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3961.2 MiB   3961.2 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3961.2 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3961.2 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3961.2 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3961.2 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3961.2 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3961.2 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3961.2 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3961.2 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3961.2 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3961.2 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 14 / 51 loss of  lively = tensor(2.0612, device='cuda:0', grad_fn=<AddBackward0>)
batch:  13 finished!
batch:  14 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3969.3 MiB   3969.3 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3969.3 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3969.3 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3969.3 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3969.3 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3969.3 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3969.3 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3969.3 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3969.3 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3969.3 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3969.3 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 15 / 51 loss of  safe = tensor(0.7513, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3971.8 MiB   3971.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3971.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3971.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3971.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3971.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3971.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3971.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3971.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3971.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3971.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3971.8 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 15 / 51 loss of  lively = tensor(2.8600, device='cuda:0', grad_fn=<AddBackward0>)
batch:  14 finished!
batch:  15 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3979.9 MiB   3979.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3979.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3979.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3979.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3979.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3979.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3979.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3979.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3979.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3979.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3979.9 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 16 / 51 loss of  safe = tensor(0.9225, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3980.1 MiB   3980.1 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3980.1 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3980.1 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3980.1 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3980.1 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3980.1 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3980.1 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3980.1 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3980.1 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3980.1 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3980.1 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 16 / 51 loss of  lively = tensor(2.4408, device='cuda:0', grad_fn=<AddBackward0>)
batch:  15 finished!
batch:  16 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3990.5 MiB   3990.5 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3990.5 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3990.5 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3990.5 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3990.5 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3990.5 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3990.5 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3990.5 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3990.5 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3990.5 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3990.5 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 17 / 51 loss of  safe = tensor(2.2873, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3990.6 MiB   3990.6 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3990.6 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3990.6 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3990.6 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3990.6 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3990.6 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3990.6 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3990.6 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3990.6 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3990.6 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3990.6 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 17 / 51 loss of  lively = tensor(0.9169, device='cuda:0', grad_fn=<AddBackward0>)
batch:  16 finished!
batch:  17 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   3998.7 MiB   3998.7 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   3998.7 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   3998.7 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   3998.7 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   3998.7 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   3998.7 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   3998.7 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   3998.7 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   3998.7 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   3998.7 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   3998.7 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 18 / 51 loss of  safe = tensor(0.7400, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4001.2 MiB   4001.2 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4001.2 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4001.2 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4001.2 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4001.2 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4001.2 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4001.2 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4001.2 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4001.2 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4001.2 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4001.2 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 18 / 51 loss of  lively = tensor(0.0420, device='cuda:0', grad_fn=<AddBackward0>)
batch:  17 finished!
batch:  18 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4009.3 MiB   4009.3 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4009.3 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4009.3 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4009.3 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4009.3 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4009.3 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4009.3 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4009.3 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4009.3 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4009.3 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4009.3 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 19 / 51 loss of  safe = tensor(1.3663, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4009.4 MiB   4009.4 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4009.4 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4009.4 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4009.4 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4009.4 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4009.4 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4009.4 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4009.4 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4009.4 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4009.4 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4009.4 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 19 / 51 loss of  lively = tensor(3.7227, device='cuda:0', grad_fn=<AddBackward0>)
batch:  18 finished!
batch:  19 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4017.6 MiB   4017.6 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4017.6 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4017.6 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4017.6 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4017.6 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4017.6 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4017.6 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4017.6 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4017.6 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4017.6 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4017.6 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 20 / 51 loss of  safe = tensor(0.7946, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4022.3 MiB   4022.3 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4022.3 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4022.3 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4022.3 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4022.3 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4022.3 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4022.3 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4022.3 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4022.3 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4022.3 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4022.3 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 20 / 51 loss of  lively = tensor(8.5995, device='cuda:0', grad_fn=<AddBackward0>)
batch:  19 finished!
batch:  20 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4030.5 MiB   4030.5 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4030.5 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4030.5 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4030.5 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4030.5 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4030.5 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4030.5 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4030.5 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4030.5 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4030.5 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4030.5 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 21 / 51 loss of  safe = tensor(0.7450, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4030.6 MiB   4030.6 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4030.6 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4030.6 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4030.6 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4030.6 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4030.6 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4030.6 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4030.6 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4030.6 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4030.6 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4030.6 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 21 / 51 loss of  lively = tensor(2.4622, device='cuda:0', grad_fn=<AddBackward0>)
batch:  20 finished!
batch:  21 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4043.3 MiB   4043.3 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4043.3 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4043.3 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4043.3 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4043.3 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4043.3 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4043.3 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4043.3 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4043.3 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4043.3 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4043.3 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 22 / 51 loss of  safe = tensor(0.9870, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4043.5 MiB   4043.5 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4043.5 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4043.5 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4043.5 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4043.5 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4043.5 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4043.5 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4043.5 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4043.5 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4043.5 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4043.5 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 22 / 51 loss of  lively = tensor(0.4314, device='cuda:0', grad_fn=<AddBackward0>)
batch:  21 finished!
batch:  22 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4051.6 MiB   4051.6 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4051.6 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4051.6 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4051.6 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4051.6 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4051.6 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4051.6 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4051.6 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4051.6 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4051.6 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4051.6 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 23 / 51 loss of  safe = tensor(0.0770, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4056.4 MiB   4056.4 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4056.4 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4056.4 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4056.4 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4056.4 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4056.4 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4056.4 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4056.4 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4056.4 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4056.4 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4056.4 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 23 / 51 loss of  lively = tensor(3.4954, device='cuda:0', grad_fn=<AddBackward0>)
batch:  22 finished!
batch:  23 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4064.6 MiB   4064.6 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4064.6 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4064.6 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4064.6 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4064.6 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4064.6 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4064.6 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4064.6 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4064.6 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4064.6 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4064.6 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 24 / 51 loss of  safe = tensor(0.0316, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4064.7 MiB   4064.7 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4064.7 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4064.7 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4064.7 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4064.7 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4064.7 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4064.7 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4064.7 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4064.7 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4064.7 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4064.7 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 24 / 51 loss of  lively = tensor(5.2610, device='cuda:0', grad_fn=<AddBackward0>)
batch:  23 finished!
batch:  24 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4075.0 MiB   4075.0 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4075.0 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4075.0 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4075.0 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4075.0 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4075.0 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4075.0 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4075.0 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4075.0 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4075.0 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4075.0 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 25 / 51 loss of  safe = tensor(2.1729, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4075.2 MiB   4075.2 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4075.2 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4075.2 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4075.2 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4075.2 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4075.2 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4075.2 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4075.2 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4075.2 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4075.2 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4075.2 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 25 / 51 loss of  lively = tensor(5.6592, device='cuda:0', grad_fn=<AddBackward0>)
batch:  24 finished!
batch:  25 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4083.3 MiB   4083.3 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4083.3 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4083.3 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4083.3 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4083.3 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4083.3 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4083.3 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4083.3 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4083.3 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4083.3 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4083.3 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 26 / 51 loss of  safe = tensor(1.9962, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4085.8 MiB   4085.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4085.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4085.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4085.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4085.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4085.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4085.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4085.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4085.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4085.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4085.8 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 26 / 51 loss of  lively = tensor(10.1519, device='cuda:0', grad_fn=<AddBackward0>)
batch:  25 finished!
batch:  26 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4093.9 MiB   4093.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4093.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4093.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4093.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4093.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4093.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4093.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4093.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4093.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4093.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4093.9 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 27 / 51 loss of  safe = tensor(0.0699, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4094.0 MiB   4094.0 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4094.0 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4094.0 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4094.0 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4094.0 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4094.0 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4094.0 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4094.0 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4094.0 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4094.0 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4094.0 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 27 / 51 loss of  lively = tensor(5.5052, device='cuda:0', grad_fn=<AddBackward0>)
batch:  26 finished!
batch:  27 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4102.2 MiB   4102.2 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4102.2 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4102.2 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4102.2 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4102.2 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4102.2 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4102.2 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4102.2 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4102.2 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4102.2 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4102.2 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 28 / 51 loss of  safe = tensor(0.9921, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4106.9 MiB   4106.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4106.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4106.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4106.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4106.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4106.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4106.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4106.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4106.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4106.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4106.9 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 28 / 51 loss of  lively = tensor(1.1522, device='cuda:0', grad_fn=<AddBackward0>)
batch:  27 finished!
batch:  28 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4115.0 MiB   4115.0 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4115.0 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4115.0 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4115.0 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4115.0 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4115.0 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4115.0 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4115.0 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4115.0 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4115.0 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4115.0 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 29 / 51 loss of  safe = tensor(0.6998, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4115.2 MiB   4115.2 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4115.2 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4115.2 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4115.2 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4115.2 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4115.2 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4115.2 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4115.2 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4115.2 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4115.2 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4115.2 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 29 / 51 loss of  lively = tensor(0.0009, device='cuda:0', grad_fn=<AddBackward0>)
batch:  28 finished!
batch:  29 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4127.9 MiB   4127.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4127.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4127.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4127.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4127.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4127.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4127.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4127.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4127.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4127.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4127.9 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 30 / 51 loss of  safe = tensor(1.5478, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4128.0 MiB   4128.0 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4128.0 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4128.0 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4128.0 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4128.0 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4128.0 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4128.0 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4128.0 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4128.0 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4128.0 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4128.0 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 30 / 51 loss of  lively = tensor(12.2412, device='cuda:0', grad_fn=<AddBackward0>)
batch:  29 finished!
batch:  30 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4136.2 MiB   4136.2 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4136.2 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4136.2 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4136.2 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4136.2 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4136.2 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4136.2 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4136.2 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4136.2 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4136.2 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4136.2 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 31 / 51 loss of  safe = tensor(0.3066, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4140.9 MiB   4140.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4140.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4140.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4140.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4140.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4140.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4140.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4140.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4140.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4140.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4140.9 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 31 / 51 loss of  lively = tensor(0.0003, device='cuda:0', grad_fn=<AddBackward0>)
batch:  30 finished!
batch:  31 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4149.0 MiB   4149.0 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4149.0 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4149.0 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4149.0 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4149.0 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4149.0 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4149.0 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4149.0 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4149.0 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4149.0 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4149.0 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 32 / 51 loss of  safe = tensor(0.8834, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4149.2 MiB   4149.2 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4149.2 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4149.2 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4149.2 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4149.2 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4149.2 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4149.2 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4149.2 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4149.2 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4149.2 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4149.2 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 32 / 51 loss of  lively = tensor(6.7120, device='cuda:0', grad_fn=<AddBackward0>)
batch:  31 finished!
batch:  32 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4159.6 MiB   4159.6 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4159.6 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4159.6 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4159.6 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4159.6 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4159.6 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4159.6 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4159.6 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4159.6 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4159.6 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4159.6 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 33 / 51 loss of  safe = tensor(0.3172, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4159.7 MiB   4159.7 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4159.7 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4159.7 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4159.7 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4159.7 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4159.7 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4159.7 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4159.7 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4159.7 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4159.7 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4159.7 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 33 / 51 loss of  lively = tensor(6.0991, device='cuda:0', grad_fn=<AddBackward0>)
batch:  32 finished!
batch:  33 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4167.9 MiB   4167.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4167.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4167.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4167.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4167.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4167.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4167.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4167.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4167.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4167.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4167.9 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 34 / 51 loss of  safe = tensor(0.8603, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4170.3 MiB   4170.3 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4170.3 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4170.3 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4170.3 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4170.3 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4170.3 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4170.3 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4170.3 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4170.3 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4170.3 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4170.3 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 34 / 51 loss of  lively = tensor(4.5663, device='cuda:0', grad_fn=<AddBackward0>)
batch:  33 finished!
batch:  34 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4178.5 MiB   4178.5 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4178.5 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4178.5 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4178.5 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4178.5 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4178.5 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4178.5 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4178.5 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4178.5 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4178.5 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4178.5 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 35 / 51 loss of  safe = tensor(0.3340, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4178.6 MiB   4178.6 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4178.6 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4178.6 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4178.6 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4178.6 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4178.6 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4178.6 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4178.6 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4178.6 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4178.6 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4178.6 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 35 / 51 loss of  lively = tensor(2.4085, device='cuda:0', grad_fn=<AddBackward0>)
batch:  34 finished!
batch:  35 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4186.7 MiB   4186.7 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4186.7 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4186.7 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4186.7 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4186.7 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4186.7 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4186.7 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4186.7 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4186.7 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4186.7 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4186.7 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 36 / 51 loss of  safe = tensor(1.0243, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4191.5 MiB   4191.5 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4191.5 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4191.5 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4191.5 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4191.5 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4191.5 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4191.5 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4191.5 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4191.5 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4191.5 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4191.5 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 36 / 51 loss of  lively = tensor(0.8424, device='cuda:0', grad_fn=<AddBackward0>)
batch:  35 finished!
batch:  36 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4199.6 MiB   4199.6 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4199.6 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4199.6 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4199.6 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4199.6 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4199.6 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4199.6 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4199.6 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4199.6 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4199.6 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4199.6 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 37 / 51 loss of  safe = tensor(1.3047, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4199.8 MiB   4199.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4199.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4199.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4199.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4199.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4199.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4199.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4199.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4199.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4199.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4199.8 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 37 / 51 loss of  lively = tensor(2.9395, device='cuda:0', grad_fn=<AddBackward0>)
batch:  36 finished!
batch:  37 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4204.5 MiB   4204.5 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4204.5 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4204.5 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4204.5 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4204.5 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4204.5 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4204.5 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4204.5 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4204.5 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4204.5 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4204.5 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 38 / 51 loss of  safe = tensor(1.4389, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4204.6 MiB   4204.6 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4204.6 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4204.6 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4204.6 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4204.6 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4204.6 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4204.6 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4204.6 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4204.6 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4204.6 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4204.6 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 38 / 51 loss of  lively = tensor(4.9040, device='cuda:0', grad_fn=<AddBackward0>)
batch:  37 finished!
batch:  38 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4212.8 MiB   4212.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4212.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4212.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4212.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4212.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4212.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4212.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4212.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4212.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4212.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4212.8 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 39 / 51 loss of  safe = tensor(0.1038, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4212.9 MiB   4212.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4212.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4212.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4212.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4212.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4212.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4212.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4212.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4212.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4212.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4212.9 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 39 / 51 loss of  lively = tensor(5.9333, device='cuda:0', grad_fn=<AddBackward0>)
batch:  38 finished!
batch:  39 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4213.0 MiB   4213.0 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4213.0 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4213.0 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4213.0 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4213.0 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4213.0 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4213.0 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4213.0 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4213.0 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4213.0 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4213.0 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 40 / 51 loss of  safe = tensor(2.1513, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4213.2 MiB   4213.2 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4213.2 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4213.2 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4213.2 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4213.2 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4213.2 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4213.2 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4213.2 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4213.2 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4213.2 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4213.2 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 40 / 51 loss of  lively = tensor(0.0003, device='cuda:0', grad_fn=<AddBackward0>)
batch:  39 finished!
batch:  40 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4215.6 MiB   4215.6 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4215.6 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4215.6 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4215.6 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4215.6 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4215.6 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4215.6 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4215.6 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4215.6 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4215.6 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4215.6 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 41 / 51 loss of  safe = tensor(0.6945, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4215.7 MiB   4215.7 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4215.7 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4215.7 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4215.7 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4215.7 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4215.7 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4215.7 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4215.7 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4215.7 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4215.7 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4215.7 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 41 / 51 loss of  lively = tensor(6.3351, device='cuda:0', grad_fn=<AddBackward0>)
batch:  40 finished!
batch:  41 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4215.9 MiB   4215.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4215.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4215.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4215.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4215.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4215.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4215.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4215.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4215.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4215.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4215.9 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 42 / 51 loss of  safe = tensor(0.9302, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4216.0 MiB   4216.0 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4216.0 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4216.0 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4216.0 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4216.0 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4216.0 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4216.0 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4216.0 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4216.0 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4216.0 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4216.0 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 42 / 51 loss of  lively = tensor(5.8349, device='cuda:0', grad_fn=<AddBackward0>)
batch:  41 finished!
batch:  42 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4216.1 MiB   4216.1 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4216.1 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4216.1 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4216.1 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4216.1 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4216.1 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4216.1 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4216.1 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4216.1 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4216.1 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4216.1 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 43 / 51 loss of  safe = tensor(1.2632, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4216.3 MiB   4216.3 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4216.3 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4216.3 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4216.3 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4216.3 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4216.3 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4216.3 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4216.3 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4216.3 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4216.3 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4216.3 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 43 / 51 loss of  lively = tensor(9.4067, device='cuda:0', grad_fn=<AddBackward0>)
batch:  42 finished!
batch:  43 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4216.4 MiB   4216.4 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4216.4 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4216.4 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4216.4 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4216.4 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4216.4 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4216.4 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4216.4 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4216.4 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4216.4 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4216.4 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 44 / 51 loss of  safe = tensor(1.3387, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4218.9 MiB   4218.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4218.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4218.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4218.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4218.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4218.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4218.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4218.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4218.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4218.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4218.9 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 44 / 51 loss of  lively = tensor(4.8797, device='cuda:0', grad_fn=<AddBackward0>)
batch:  43 finished!
batch:  44 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4219.0 MiB   4219.0 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4219.0 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4219.0 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4219.0 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4219.0 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4219.0 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4219.0 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4219.0 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4219.0 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4219.0 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4219.0 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 45 / 51 loss of  safe = tensor(0.1295, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4219.1 MiB   4219.1 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4219.1 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4219.1 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4219.1 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4219.1 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4219.1 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4219.1 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4219.1 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4219.1 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4219.1 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4219.1 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 45 / 51 loss of  lively = tensor(1.7489, device='cuda:0', grad_fn=<AddBackward0>)
batch:  44 finished!
batch:  45 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4219.3 MiB   4219.3 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4219.3 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4219.3 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4219.3 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4219.3 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4219.3 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4219.3 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4219.3 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4219.3 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4219.3 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4219.3 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 46 / 51 loss of  safe = tensor(0.1667, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4219.4 MiB   4219.4 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4219.4 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4219.4 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4219.4 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4219.4 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4219.4 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4219.4 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4219.4 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4219.4 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4219.4 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4219.4 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 46 / 51 loss of  lively = tensor(2.5895, device='cuda:0', grad_fn=<AddBackward0>)
batch:  45 finished!
batch:  46 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4219.6 MiB   4219.6 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4219.6 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4219.6 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4219.6 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4219.6 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4219.6 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4219.6 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4219.6 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4219.6 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4219.6 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4219.6 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 47 / 51 loss of  safe = tensor(1.8804, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4219.7 MiB   4219.7 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4219.7 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4219.7 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4219.7 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4219.7 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4219.7 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4219.7 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4219.7 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4219.7 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4219.7 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4219.7 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 47 / 51 loss of  lively = tensor(0.0010, device='cuda:0', grad_fn=<AddBackward0>)
batch:  46 finished!
batch:  47 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4219.8 MiB   4219.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4219.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4219.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4219.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4219.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4219.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4219.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4219.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4219.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4219.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4219.8 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 48 / 51 loss of  safe = tensor(0.5051, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4220.0 MiB   4220.0 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4220.0 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4220.0 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4220.0 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4220.0 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4220.0 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4220.0 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4220.0 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4220.0 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4220.0 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4220.0 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 48 / 51 loss of  lively = tensor(0.0004, device='cuda:0', grad_fn=<AddBackward0>)
batch:  47 finished!
batch:  48 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4220.1 MiB   4220.1 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4220.1 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4220.1 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4220.1 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4220.1 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4220.1 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4220.1 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4220.1 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4220.1 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4220.1 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4220.1 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 49 / 51 loss of  safe = tensor(0.6953, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4220.2 MiB   4220.2 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4220.2 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4220.2 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4220.2 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4220.2 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4220.2 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4220.2 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4220.2 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4220.2 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4220.2 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4220.2 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 49 / 51 loss of  lively = tensor(0.0003, device='cuda:0', grad_fn=<AddBackward0>)
batch:  48 finished!
batch:  49 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4220.4 MiB   4220.4 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4220.4 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4220.4 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4220.4 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4220.4 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4220.4 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4220.4 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4220.4 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4220.4 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4220.4 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4220.4 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 50 / 51 loss of  safe = tensor(0.7371, device='cuda:0', grad_fn=<AddBackward0>)
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4220.5 MiB   4220.5 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4220.5 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4220.5 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4220.5 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4220.5 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4220.5 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4220.5 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4220.5 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4220.5 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4220.5 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4220.5 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 50 / 51 loss of  lively = tensor(6.0011, device='cuda:0', grad_fn=<AddBackward0>)
batch:  49 finished!
batch:  50 starts!
cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4220.6 MiB   4220.6 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4220.6 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4220.6 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4220.6 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4220.6 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4220.6 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4220.6 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4220.6 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4220.6 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4220.6 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4220.6 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 51 / 51 loss of  safe = tensor(0.7578, device='cuda:0', grad_fn=<AddBackward0>)
**********test on data_validation of attribute safe  start ************
safe torch.Size([2, 3, 224, 224]) torch.Size([2, 3, 224, 224]) torch.Size([2])
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4220.7 MiB   4220.7 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4220.7 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4220.7 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4220.7 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4220.7 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4220.7 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4220.7 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4220.7 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4220.7 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4220.7 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4220.7 MiB      0.0 MiB           1       return feature


safe tensor([[ 0.5038, -0.1683],
        [ 0.5024, -0.1691]], device='cuda:0', grad_fn=<AddmmBackward0>)
times=  1
safe torch.Size([2, 3, 224, 224]) torch.Size([2, 3, 224, 224]) torch.Size([2])
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4220.7 MiB   4220.7 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4220.7 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4220.7 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4220.7 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4220.7 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4220.7 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4220.7 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4220.7 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4220.7 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4220.7 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4220.7 MiB      0.0 MiB           1       return feature


safe tensor([[ 0.5090, -0.1776],
        [ 0.5102, -0.1787]], device='cuda:0', grad_fn=<AddmmBackward0>)
times=  2
safe torch.Size([2, 3, 224, 224]) torch.Size([2, 3, 224, 224]) torch.Size([2])
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4220.8 MiB   4220.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4220.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4220.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4220.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4220.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4220.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4220.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4220.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4220.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4220.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4220.8 MiB      0.0 MiB           1       return feature


safe tensor([[ 0.5052, -0.1661],
        [ 0.5095, -0.1751]], device='cuda:0', grad_fn=<AddmmBackward0>)
times=  3
safe torch.Size([2, 3, 224, 224]) torch.Size([2, 3, 224, 224]) torch.Size([2])
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4220.8 MiB   4220.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4220.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4220.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4220.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4220.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4220.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4220.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4220.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4220.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4220.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4220.8 MiB      0.0 MiB           1       return feature


safe tensor([[ 0.4924, -0.1561],
        [ 0.5003, -0.1685]], device='cuda:0', grad_fn=<AddmmBackward0>)
times=  4
validation accuracy of  safe = 0.5
change of accuracy on data_train safe:
0.5392156862745098
change of accuracy on data_validation safe:
0.5
**********test on data_validation of attribute safe  finished ************


cuda:0 cuda:0 cuda:0
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4208.7 MiB   4208.7 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4208.7 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4208.7 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4208.7 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4208.7 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4208.7 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4208.7 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4208.7 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4208.7 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4208.7 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4208.7 MiB      0.0 MiB           1       return feature


loss cuda:0
epoch= 1 iteration= 51 / 51 loss of  lively = tensor(5.9929, device='cuda:0', grad_fn=<AddBackward0>)
**********test on data_validation of attribute lively  start ************
lively torch.Size([2, 3, 224, 224]) torch.Size([2, 3, 224, 224]) torch.Size([2])
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4213.7 MiB   4213.7 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4213.7 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4213.7 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4213.7 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4213.7 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4213.7 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4213.7 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4213.7 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4213.7 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4213.7 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4213.7 MiB      0.0 MiB           1       return feature


lively tensor([[-5.2232,  5.5406],
        [-5.2518,  5.5819]], device='cuda:0', grad_fn=<AddmmBackward0>)
times=  1
lively torch.Size([2, 3, 224, 224]) torch.Size([2, 3, 224, 224]) torch.Size([2])
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4213.7 MiB   4213.7 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4213.7 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4213.7 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4213.7 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4213.7 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4213.7 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4213.7 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4213.7 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4213.7 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4213.7 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4213.7 MiB      0.0 MiB           1       return feature


lively tensor([[-5.2281,  5.5571],
        [-5.2441,  5.5675]], device='cuda:0', grad_fn=<AddmmBackward0>)
times=  2
lively torch.Size([2, 3, 224, 224]) torch.Size([2, 3, 224, 224]) torch.Size([2])
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4213.7 MiB   4213.7 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4213.7 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4213.7 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4213.7 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4213.7 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4213.7 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4213.7 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4213.7 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4213.7 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4213.7 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4213.7 MiB      0.0 MiB           1       return feature


lively tensor([[-5.2443,  5.5686],
        [-5.2321,  5.5584]], device='cuda:0', grad_fn=<AddmmBackward0>)
times=  3
validation accuracy of  lively = 0.6666666666666666
change of accuracy on data_train lively:
0.5490196078431373
change of accuracy on data_validation lively:
0.6666666666666666
**********test on data_validation of attribute lively  finished ************


batch:  50 finished!


epoch 0 finished, changes of losses as following: 
change of loss safe every epoch:
tensor(2.2924, device='cuda:0', grad_fn=<DivBackward0>)
change of loss lively every epoch:
tensor(4.0552, device='cuda:0', grad_fn=<DivBackward0>)


**********test on data_test of attribute  safe  start ************
tensor([0., 1.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4496.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4496.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4496.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4496.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4496.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.5
tensor([1., 1.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4496.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4496.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4496.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4496.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4496.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.25
tensor([1., 1.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4496.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4496.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4496.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4496.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4496.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.16666666666666666
tensor([1., 1.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4496.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4496.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4496.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4496.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4496.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.125
tensor([1., 1.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4496.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4496.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4496.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4496.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4496.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.1
tensor([0., 0.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4496.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4496.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4496.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4496.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4496.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.25
tensor([1., 0.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4496.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4496.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4496.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4496.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4496.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.2857142857142857
tensor([0., 1.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4496.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4496.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4496.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4496.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4496.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.3125
tensor([1., 1.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4496.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4496.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4496.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4496.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4496.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.2777777777777778
tensor([0., 0.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4496.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4496.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4496.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4496.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4496.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.35
tensor([0., 1.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4496.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4496.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4496.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4496.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4496.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.36363636363636365
tensor([0., 1.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4496.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4496.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4496.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4496.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4496.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.375
tensor([0., 1.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4496.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4496.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4496.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4496.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4496.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.38461538461538464
tensor([0., 0.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4496.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4496.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4496.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4496.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4496.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.42857142857142855
tensor([1., 0.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4496.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4496.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4496.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4496.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4496.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.43333333333333335
tensor([1., 0.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4496.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4496.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4496.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4496.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4496.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.4375
tensor([1., 0.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4496.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4496.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4496.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4496.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4496.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.4411764705882353
tensor([0., 0.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4496.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4496.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4496.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4496.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4496.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4496.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4496.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.4722222222222222
tensor([0., 0.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4496.9 MiB   4496.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4497.0 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4497.0 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4497.0 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4497.0 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4497.0 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4497.0 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4497.0 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4497.0 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4497.0 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4497.0 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.5
tensor([0., 1.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4497.0 MiB   4497.0 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4497.0 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4497.0 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4497.0 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4497.0 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4497.0 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4497.0 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4497.0 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4497.0 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4497.0 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4497.0 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.5
tensor([1., 0.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4497.0 MiB   4497.0 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4497.0 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4497.0 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4497.0 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4497.0 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4497.0 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4497.0 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4497.0 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4497.0 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4497.0 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4497.0 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.5
tensor([1., 0.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4497.0 MiB   4497.0 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4497.0 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4497.0 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4497.0 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4497.0 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4497.0 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4497.0 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4497.0 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4497.0 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4497.0 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4497.0 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.5
tensor([1., 1.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4497.0 MiB   4497.0 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4497.0 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4497.0 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4497.0 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4497.0 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4497.0 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4497.0 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4497.0 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4497.0 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4497.0 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4497.0 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.4782608695652174
tensor([1., 0.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.4791666666666667
tensor([1., 1.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.46
tensor([0., 1.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.46153846153846156
tensor([0., 0.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.48148148148148145
tensor([0., 0.], device='cuda:0') safe
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue safe : 0.5


**********test on data_test of attribute  lively  start ************
tensor([1., 0.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.5
tensor([1., 1.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.75
tensor([0., 1.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.6666666666666666
tensor([0., 1.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.625
tensor([1., 0.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.6
tensor([0., 0.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.5
tensor([0., 0.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.42857142857142855
tensor([0., 0.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.375
tensor([1., 1.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.4444444444444444
tensor([0., 1.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.45
tensor([0., 1.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.45454545454545453
tensor([0., 1.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.4583333333333333
tensor([1., 0.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.46153846153846156
tensor([0., 1.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.4642857142857143
tensor([0., 1.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.4666666666666667
tensor([0., 1.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.46875
tensor([1., 0.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.47058823529411764
tensor([1., 0.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.4722222222222222
tensor([1., 0.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.8 MiB   4339.8 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.8 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.8 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.8 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.8 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.8 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.8 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.8 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.47368421052631576
tensor([0., 1.], device='cuda:0') lively
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   115   4339.9 MiB   4339.9 MiB           1   @profile
   116                                         def fusion(img_l,img_r,vgg_extra):
   117   4339.9 MiB      0.0 MiB           1       left_feature = vgg_extra.avgpool(vgg_extra.features(img_l))
   118   4339.9 MiB      0.0 MiB           1       right_feature = vgg_extra.avgpool(vgg_extra.features(img_r))
   119   4339.9 MiB      0.0 MiB           1       left_feature = left_feature.reshape((batch_size, 512, -1))
   120   4339.9 MiB      0.0 MiB           1       left_feature = left_feature.squeeze()
   121   4339.9 MiB      0.0 MiB           1       right_feature = right_feature.reshape((batch_size, 512, -1))
   122   4339.9 MiB      0.0 MiB           1       right_feature = right_feature.squeeze()
   123                                         
   124   4339.9 MiB      0.0 MiB           1       left_feature = left_feature.permute(0, 2, 1)
   125   4339.9 MiB      0.0 MiB           1       join_feature = torch.bmm(left_feature, right_feature)
   126   4339.9 MiB      0.0 MiB           1       feature = join_feature.unsqueeze(dim=1)
   127   4339.9 MiB      0.0 MiB           1       return feature


accuracy on data_test of attribtue lively : 0.475
[0] [2.29236387]
[0] [4.05518374]
Filename: /workspace/shared/DRAMAinPT_test_v10.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
   207    291.5 MiB    291.5 MiB           1   @profile
   208                                         def main(epoch,image_dir,csv_dir,outputdir,hdf5_path,t,workers,device,batch_size,img_w,img_h,test_iteration):
   209                                             #inspect GPU
   210    291.5 MiB      0.0 MiB           1       frame = inspect.currentframe()
   211    291.5 MiB      0.0 MiB           1       gpu_tracker = MemTracker(frame)
   212    297.8 MiB      6.3 MiB           1       gpu_tracker.track()
   213                                         
   214                                             #prepare network
   215    297.8 MiB      0.0 MiB           1       print('DRAMAinPT_final starts!')
   216                                             #mynet = {'safe':MyNet().to(device),'lively':MyNet().to(device),'beautiful':MyNet().to(device),'wealthy':MyNet().to(device),'depressing':MyNet().to(device),'boring':MyNet().to(device)}
   217    298.2 MiB      0.4 MiB           1       mynet = [MyNet(),MyNet()]
   218   1403.4 MiB   1105.3 MiB           1       vgg_extra = create_vgg19('./vgg_extractor')
   219   1403.4 MiB      0.0 MiB           1       print('finish loading networks')
   220   2921.0 MiB   1517.5 MiB           1       vgg_extra.to(device)
   221                                         
   222   2921.2 MiB      0.2 MiB           1       gpu_tracker.track()
   223                                         
   224   2921.2 MiB      0.0 MiB           1       criterion = nn.CrossEntropyLoss()
   225   2921.2 MiB      0.0 MiB           1       optimizer_vgg = optim.SGD(vgg_extra.parameters(), lr=0.001, momentum=0.5)
   226   2921.2 MiB      0.0 MiB           1       optimizer_mynet = []
   227   2921.2 MiB      0.0 MiB           3       for net in mynet:
   228   2921.2 MiB      0.0 MiB           2           optimizer_mynet.append(optim.Adam(net.parameters(), lr=0.001))
   229                                         
   230                                             #prepare data
   231   2921.7 MiB      0.6 MiB           1       data_loader_train,data_loader_test,data_loader_val,num_train,num_validation,num_test = get(csv_dir)#num is the number of training data
   232   2921.7 MiB      0.0 MiB           1       list_val_acc = {'safe':[],'lively':[]}
   233   2921.7 MiB      0.0 MiB           1       list_train_acc = {'safe':[],'lively':[]}
   234   2921.7 MiB      0.0 MiB           1       list_loss = {'safe':[],'lively':[]}
   235   2921.7 MiB      0.0 MiB           1       max_acc = {'safe':0,'lively':0}
   236   2921.7 MiB      0.0 MiB           1       acc_train = {'safe':0,'lively':0}
   237   2921.7 MiB      0.0 MiB           1       max_iterations = max(num_train.values())//batch_size
   238                                         
   239   2921.7 MiB      0.0 MiB           2       data_loader_train_final = zip(data_loader_train['safe'], \
   240   2921.7 MiB      0.0 MiB           1                                     cycle(data_loader_train['lively']))
   241                                         
   242                                         
   243   2921.7 MiB      0.0 MiB           1       dic={0:'safe',1:'lively'}
   244                                             #train loop
   245   4213.8 MiB      0.0 MiB           2       for epo in range(epoch):
   246   2921.7 MiB      0.0 MiB           1           sum_loss = {'safe':0,'lively':0}
   247   4220.6 MiB    353.4 MiB          52           for iteration, img1img2target in enumerate(data_loader_train_final):
   248   4220.6 MiB      0.0 MiB          51               print('batch: ', iteration,'starts!')
   249   4220.6 MiB      0.0 MiB         153               for k in range(2):
   250   4220.6 MiB    -11.9 MiB         102                   img1, img2, target = img1img2target[k]
   251                                         
   252   4220.6 MiB     -7.2 MiB         102                   gpu_tracker.track()
   253   4220.6 MiB    -11.9 MiB         102                   img1, img2, target = img1.to(device),img2.to(device),target.to(device)
   254   4220.6 MiB    -11.9 MiB         102                   print(img1.device, img2.device, target.device)
   255   4220.6 MiB      0.1 MiB         102                   gpu_tracker.track()
   256                                         
   257   4220.6 MiB    -11.9 MiB         102                   loss = 0.0
   258   4220.6 MiB    -11.9 MiB         102                   optimizer_mynet[k].zero_grad()
   259   4220.6 MiB    -11.9 MiB         102                   optimizer_vgg.zero_grad()
   260                                         
   261   4220.6 MiB     27.5 MiB         102                   gpu_tracker.track()
   262   4220.6 MiB    802.8 MiB         102                   feature = fusion(img1, img2,vgg_extra)
   263                                         
   264   4220.7 MiB     12.8 MiB         102                   gpu_tracker.track()
   265   4220.7 MiB    -11.9 MiB         102                   mynet[k].to(device)
   266   4220.7 MiB     18.6 MiB         102                   gpu_tracker.track()
   267                                         
   268   4220.7 MiB    -11.8 MiB         102                   output,w = mynet[k](feature)
   269   4220.7 MiB     -4.9 MiB         102                   loss = criterion(output,target.long())+10*torch.mean(torch.mul(w, w))#why +10*nd.mean(w**2)
   270   4220.7 MiB    -11.9 MiB         102                   print('loss', loss.device)
   271                                         
   272   4220.7 MiB    -11.8 MiB         102                   acc_tmp = evaluate_accuracy(output, target)
   273   4220.7 MiB    -11.9 MiB         102                   acc_train[dic[k]] += acc_tmp
   274   4220.7 MiB    -11.6 MiB         102                   print('epoch=', epo + 1, 'iteration=', iteration + 1, '/', max_iterations, 'loss of ', dic[k], '=', loss)
   275   4220.7 MiB     -5.1 MiB         102                   gpu_tracker.track()
   276                                         
   277   4220.7 MiB     -5.5 MiB         102                   loss.backward()
   278   4220.7 MiB     -6.9 MiB         102                   optimizer_vgg.step()
   279   4220.7 MiB     -6.9 MiB         102                   optimizer_mynet[k].step()
   280   4220.7 MiB     -7.0 MiB         102                   sum_loss[dic[k]]+=loss
   281   4220.7 MiB     -5.6 MiB         102                   gpu_tracker.track()
   282                                         
   283                                         
   284                                         
   285                                                         #summary accuracy
   286   4220.7 MiB     -7.0 MiB         102                   if iteration%test_iteration==test_iteration-1 or iteration== max_iterations-1:#after 4000 times or all ready train one epoch,start val
   287   4220.7 MiB     -7.0 MiB           2                       if iteration%test_iteration==test_iteration-1:
   288                                                                 list_train_acc[dic[k]].append(acc_train[dic[k]]/test_iteration)
   289                                                             else:
   290   4220.7 MiB     -7.0 MiB           2                           list_train_acc[dic[k]].append(acc_train[dic[k]]/(max_iterations%test_iteration))
   291                                         
   292                                                             #validation
   293   4220.7 MiB     -7.0 MiB           2                       print('**********test on data_validation of attribute',dic[k],' start ************')
   294   4220.7 MiB     -7.0 MiB           2                       acc_train[dic[k]] = 0
   295   4220.7 MiB     -7.0 MiB           2                       accuracy_val = 0
   296                                                            #for times, img1img2target in enumerate(data_loader_val_final):
   297   4220.8 MiB    -28.3 MiB           9                       for times, (img1_val, img2_val, target_val) in enumerate(data_loader_val[dic[k]]):
   298   4220.8 MiB    -21.3 MiB           7                           img1_val, img2_val, target_val = img1_val.to(device), img2_val.to(device), target_val.to(device)
   299   4220.8 MiB    -21.3 MiB           7                           print(dic[k],img1_val.size(),img2_val.size(),target_val.size())
   300   4220.8 MiB    -21.3 MiB           7                           val_feature = fusion(img1_val,img2_val,vgg_extra)
   301   4220.8 MiB    -21.3 MiB           7                           val_output,_ = mynet[k](val_feature)
   302   4220.8 MiB    -21.3 MiB           7                           print(dic[k], val_output)
   303                                         
   304   4220.8 MiB    -21.3 MiB           7                           acc_tmp_val = evaluate_accuracy(val_output, target_val)
   305   4220.8 MiB    -21.3 MiB           7                           accuracy_val += acc_tmp_val
   306   4220.8 MiB    -21.3 MiB           7                           print('times= ',(times+1))
   307   4220.8 MiB     -7.1 MiB           2                       list_val_acc[dic[k]].append(accuracy_val/(times+1))
   308   4220.8 MiB     -7.1 MiB           2                       print('validation accuracy of ',dic[k], '=', accuracy_val/(times+1))
   309   4220.8 MiB     -7.1 MiB           2                       if accuracy_val/(times+1)>max_acc[dic[k]]:
   310   4220.8 MiB     -7.1 MiB           2                           max_acc[dic[k]] = accuracy_val/(times+1)
   311   4213.8 MiB    -19.1 MiB           2                           torch.save(vgg_extra.state_dict(), outputdir+'/'+'vgg_params')
   312   4213.8 MiB      0.0 MiB           2                           torch.save(mynet[k].state_dict(), outputdir+'/'+'mynet'+dic[k]+'_params')
   313                                                             #show changes
   314   4213.8 MiB      0.0 MiB           2                       print('change of accuracy on data_train ' + str(dic[k]) + ':')
   315   4213.8 MiB      0.0 MiB           4                       for i in list_train_acc[dic[k]]:
   316   4213.8 MiB      0.0 MiB           2                           print(i)
   317   4213.8 MiB      0.0 MiB           2                       print('change of accuracy on data_validation '+str(dic[k])+':')
   318   4213.8 MiB      0.0 MiB           4                       for i in list_val_acc[dic[k]]:
   319   4213.8 MiB      0.0 MiB           2                            print(i)
   320   4213.8 MiB      0.0 MiB           2                       print('**********test on data_validation of attribute',dic[k],' finished ************')
   321   4213.8 MiB      0.0 MiB           2                       print('\n')
   322   4220.6 MiB     -6.8 MiB          51               print('batch: ', iteration, 'finished!')
   323                                         
   324   4213.8 MiB     -6.8 MiB           1           print('\n')
   325   4213.8 MiB      0.0 MiB           1           print('epoch '+str(epo)+ ' finished, changes of losses as following: ')
   326   4213.8 MiB      0.0 MiB           3           for j in sum_loss:
   327   4213.8 MiB      0.0 MiB           2               if max_iterations == 0:
   328                                                         continue
   329   4213.8 MiB      0.0 MiB           2               list_loss[j].append(sum_loss[j]/max_iterations)
   330   4213.8 MiB      0.0 MiB           2               print('change of loss '+str(j)+' every epoch:')
   331   4213.8 MiB      0.0 MiB           4               for i in list_loss[j]:
   332   4213.8 MiB      0.0 MiB           2                   print(i)
   333                                         
   334                                         
   335                                             #test
   336   4388.9 MiB    175.1 MiB           1       vgg_extra_test = models.vgg19(pretrained = False).to(device)
   337   4496.9 MiB    108.0 MiB           1       vgg_extra_test.load_state_dict(torch.load(outputdir+'/'+'vgg_params'))
   338   4496.9 MiB      0.0 MiB           1       vgg_extra_test.eval()
   339   4496.9 MiB      0.0 MiB           1       mynet_test = [MyNet().to(device),MyNet().to(device)]
   340                                             #mynet_test= {'safe':MyNet().to(device),'lively':MyNet().to(device),'beautiful':MyNet().to(device),'wealthy':MyNet().to(device),'depressing':MyNet().to(device),'boring':MyNet().to(device)}
   341   4496.9 MiB      0.0 MiB           1       acc_test={'safe':0,'lively':0}
   342                                         
   343   4496.9 MiB   -314.2 MiB           3       for k in range(2):
   344   4496.9 MiB   -157.1 MiB           2           print('\n')
   345   4496.9 MiB   -157.1 MiB           2           print('**********test on data_test of attribute ', dic[k], ' start ************')
   346   4496.9 MiB   -157.1 MiB           2           times = 0
   347   4496.9 MiB   -157.1 MiB           2           mynet_test[k].load_state_dict(torch.load(outputdir + '/' + 'mynet' + dic[k] + '_params'))
   348   4496.9 MiB   -157.1 MiB           2           mynet_test[k].eval()
   349   4497.0 MiB  -4242.0 MiB          50           for iteration, (img1, img2, target) in enumerate(data_loader_test[dic[k]]):
   350   4497.0 MiB  -3927.9 MiB          48               img1, img2, target = img1.to(device), img2.to(device), target.to(device)
   351   4497.0 MiB  -3927.9 MiB          48               print(target, dic[k])
   352   4497.0 MiB  -3927.9 MiB          48               te_feature = fusion(img1, img2,vgg_extra_test)
   353   4497.0 MiB  -3927.9 MiB          48               te_output,_ = mynet_test[k](te_feature)
   354   4497.0 MiB  -3927.9 MiB          48               acc_tmp = evaluate_accuracy(te_output, target)
   355   4497.0 MiB  -3927.9 MiB          48               acc_test[dic[k]] += acc_tmp
   356   4497.0 MiB  -3927.9 MiB          48               times = times+1
   357   4497.0 MiB  -3927.9 MiB          48               print('accuracy on data_test of attribtue',dic[k],':',acc_test[dic[k]]/times)
   358                                         
   359                                             #plot
   360   4351.3 MiB   -145.6 MiB           1       plot_loss_accuracy(list_loss,list_train_acc,list_val_acc,epoch)


